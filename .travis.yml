# Blog post showing how to update gcc version.
# http://genbattle.bitbucket.org/blog/2016/01/17/c++-travis-ci/
---
addons:
  apt:
    sources:
    # add PPAs with more up-to-date toolchains
    - ubuntu-toolchain-r-test
    #- llvm-toolchain-precise-3.6
    packages:
    - pigz
    - curl
    - zlib1g-dev
    #- libncurses5-dev
    # install toolchains
    #- gcc-5
    #- g++-5
    #- clang-3.6
#addons:
#  apt:
#  sources:
#    - ubuntu-toolchain-r-test
#  packages:
#    - gcc-4.9
#    - g++-4.9
#    - zlib1g-dev
#    - libbz2-dev
env:
  global:
    - SRC=$HOME/src
    - LOCAL=$HOME/packages
    #- CC=/usr/bin/gcc-5
    #- CXX=/usr/bin/g++-5
    - PATH=${HOME}/bin:$PATH
  #matrix:
  #  - FOO=BAR

before_install:
  - mkdir -p ${HOME}/bin
  - ln -s /usr/bin/pigz ${HOME}/bin/gzip
  - ln -s /usr/bin/pigz ${HOME}/bin/gunzip
  - ln -s /usr/bin/pigz ${HOME}/bin/zcat
script:
  - echo ${SRC} ${LOCAL}
  - gcc --version
  - ls -lh /usr/bin | grep gcc
  - make -j $(shell grep -c ^processor /proc/cpuinfo) -f samtools.mk SAMTOOLS_VERSION=1.2
after_failure:
  - cat /home/travis/src/samtools/1.3/config.log
  - install --help
